---
title: 'Configure Akamai on Zephyr'
description: 'Configuring Akamai as your deployment integration provider on Zephyr'
---

import { Steps, Badge } from '@theme';
import { Button } from '../../components/ui/button.tsx';
import { Separator } from '../../components/ui/separator.tsx';
import { CustomDomain } from '../../components/cloud-provider.tsx';

# Configure Akamai on Zephyr

TODO: add text

## Prerequisites

:::info

- A registered Akamai account, contract must include edge workers and edgekv
- A registered Zephyr account
- A registered domain

:::

## Configure and enable Akamai

<Steps>
### Log in to the Zephyr Dashboard
<a href="https://app.zephyr-cloud.io">
<Button variant="outline" className="hover:bg-zinc-100 hover:text-black">Dashboard</Button>
</a>
After signing in, select your organization.
<br/>

### Locate Akamai under Deployment Integration

- Select **Settings** from the top navigation tabs.
- On the left sidebar, select **Deployment Integration**.
- Choose **Available** to find Akamai, then click on **Add integration**.

### Retrieve Credentials and Configure Akamai

Before proceeding, you will need some data from Akamai:

#### 1. API Token

- Click on **Identity and access** in the menu
- Click on **Create API client**
- Choose **Advanced**
- Configure required permissions and remove the rest:

| API                               | Access Level |
| :-------------------------------- | :----------: |
| CPcode and Reporting group (cprg) | READ-WRITE   |
| Edge Hostnames API (hapi)         | READ-WRITE   |
| EdgeKV                            | READ-WRITE   |
| EdgeWorkers                       | READ-WRITE   |
| Property Manager (PAPI)           | READ-WRITE   |

- Copy or download token and add `[default]` as a header, so token will look like:
```
[default]
client_secret = <secret>
host = <host>
access_token = <access_token>
client_token = <client_token>
```

#### 2. Contract id

- Click on **Contracts** in the menu
- Find your contract id

#### 3. Group id

- Click on **Properties** in the menu
- Numeric value in the url is your group id `https://control.akamai.com/apps/property-manager/#/groups/<groupId>/properties`

#### 4. Product id

Find you product [here](https://techdocs.akamai.com/property-mgr/reference/id-prefixes#common-product-ids) and choose product id - **prd_Fresca** or **prd_SPM**


### Configuration Inputs

Details for each input after clicking **Add Integration** under **Akamai**:

<dt>Integration Name</dt>
<dd>
  A unique name within your organization, used as a slug.
</dd>

<dt>Integration Display Name</dt>
<dd>
  The name of the integration shown on the dashboard.
</dd>

<dt>API Token</dt>
<dd>
  Obtainable from Akamai. [See instructions](#1-api-token) for creating your API token.
</dd>

<dt>Domain</dt>
<dd>
  Your domain.
</dd>

<dt>Akamai contract id</dt>
<dd>
  Obtainable from Akamai. [See instructions](#2-contract-id) for getting your contract id.
</dd>

<dt>Akamai group id</dt>
<dd>
  Obtainable from Akamai. [See instructions](#3-group-id) for getting your group id.
</dd>

<dt>Akamai product id</dt>
<dd>
  Obtainable from Akamai. [See instructions](#4-product-id) for getting your product id.
</dd>

<dt>Set Integration as Default</dt>
<dd>
  When set as default, all Zephyr deployments will use this integration until a
  new one (default integration) is set. Won't work until akamai worker and property become activated.
</dd>

### Validate domain and setup DNS

- Click on **Properties** in the menu
- Click on your property
- Click on active version
- Go to section **Property hostnames**
- Click on **...** in **Actions** column near any hostname, click **Validate certificate domain** and copy **CNAME Record** value
- Go to your domain provider (e.g., GoDaddy)
- Add some CNAME records

  | Subdomain                         | Type  | Value                                      |
  |-----------------------------------|-------|--------------------------------------------|
  | _acme-challenge.ze.yourdomain.com | CNAME | &lt;value from veerifitcation record&gt;   |
  | ze.yourdomain.com                 | CNAME | ze.yourdomain.com.edgesuite.net.           |
  | *.ze.yourdomain.com               | CNAME | ze.yourdomain.com.edgesuite.net.           |

### Wait until worker and property become activated

</Steps>

### What Will Be Created on Your Akamai Account?

When Akamai is added as your provider on Zephyr, these properties will be created on your Akamai account:

#### 1. EdgeKV Namespace

- `ze-yourdomain-com`

#### 2. EdgeKV access token

- `ekv-token-ze-yourdomain-com`

#### 3. Workers

- `ze.yourdomain.com` (for uploading and serving assets)

#### 4. Property

- `ze.yourdomain.com`

## Clean Uninstall and Reset

:::danger Warning

- Zephyr Cloud does not manage deletion of API tokens or any Akamai account properties.
- Assets and information on your Akamai account are immutable by default. During a **clean uninstall**, previously deployed assets and information are unrecoverable.

:::

To delete an existing Akamai integration, follow these steps:

### Deactivate property

1. Click on **Properties** in the menu
2. Click on your property
3. Click on three **...** in the **Actions** column in the active version line
4. Choose **Deactivate Production**
5. Wait until property become deactivated
6. Go back to properties list
7. Click on three **...** in the **Actions** column in the your property line
8. Choose **Delete Property**

### Deactivate worker

1. Click on **EdgeWorkers** in the menu
2. Click on your worker
3. Click on three **...** in the **Actions** column in the active version line
4. Choose **Deactivate version**
5. Wait until version become deactivated
6. Go back to workers list
7. Click on three **...** in the **Actions** column in the your worker line
8. Choose **Delete EdgeWorker ID**

### Remove edge hostname

1. Click on ** Edge Hostnames** in the menu
2. Click on three **...** in the **Actions** column in the active version line
3. Choose **Delete Edge Hostname**

### Remove EdgeKV namespace

Can me done only with [akamai api](https://techdocs.akamai.com/edgekv/reference/delete-namespace).

### Revoke EdgeKV access token

Can me done with [akamai cli](https://github.com/akamai/cli-edgeworkers/blob/master/docs/edgekv_cli.md#revoke-access-token) or [akamai api](https://techdocs.akamai.com/edgekv/reference/delete-namespace).
